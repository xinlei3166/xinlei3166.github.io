import{_ as s,c as i,o as a,ag as n}from"./chunks/framework.CgtRPpXH.js";const g=JSON.parse('{"title":"æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶","description":"","frontmatter":{"title":"æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶","tags":["JavaScript","Vue"],"categories":["JavaScript"]},"headers":[],"relativePath":"blog/JavaScript/æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶.md","filePath":"blog/JavaScript/æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶.md","lastUpdated":1733335015000}'),p={name:"blog/JavaScript/æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶.md"},t=n(`<h1 id="æ¢ç´¢vueé«˜é˜¶ç»„ä»¶" tabindex="-1">æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶ <a class="header-anchor" href="#æ¢ç´¢vueé«˜é˜¶ç»„ä»¶" aria-label="Permalink to &quot;æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶&quot;">â€‹</a></h1><p>é«˜é˜¶ç»„ä»¶(<code>HOC</code>)æ˜¯ <code>React</code> ç”Ÿæ€ç³»ç»Ÿçš„å¸¸ç”¨è¯æ±‡ï¼Œ<code>React</code> ä¸­ä»£ç å¤ç”¨çš„ä¸»è¦æ–¹å¼å°±æ˜¯ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå¹¶ä¸”è¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„åšæ³•ã€‚è€Œ <code>Vue</code> ä¸­å¤ç”¨ä»£ç çš„ä¸»è¦æ–¹å¼æ˜¯ä½¿ç”¨ <code>mixins</code>ï¼Œå¹¶ä¸”åœ¨ <code>Vue</code> ä¸­å¾ˆå°‘æåˆ°é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µï¼Œè¿™æ˜¯å› ä¸ºåœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶å¹¶ä¸åƒ <code>React</code> ä¸­é‚£æ ·ç®€å•ï¼ŒåŸå› åœ¨äº <code>React</code> å’Œ <code>Vue</code> çš„è®¾è®¡æ€æƒ³ä¸åŒï¼Œä½†å¹¶ä¸æ˜¯è¯´åœ¨ <code>Vue</code> ä¸­å°±ä¸èƒ½ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œåªä¸è¿‡åœ¨ <code>Vue</code> ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ‰€å¸¦æ¥çš„æ”¶ç›Šç›¸å¯¹äº <code>mixins</code> å¹¶æ²¡æœ‰è´¨çš„å˜åŒ–ã€‚æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»æŠ€æœ¯æ€§çš„è§’åº¦é˜è¿° <code>Vue</code> é«˜é˜¶ç»„ä»¶çš„å®ç°ï¼Œä¸”ä¼šä» <code>React</code> ä¸ <code>Vue</code> ä¸¤è€…çš„è§’åº¦è¿›è¡Œåˆ†æã€‚</p><h2 id="ä»-react-è¯´èµ·" tabindex="-1">ä» React è¯´èµ· <a class="header-anchor" href="#ä»-react-è¯´èµ·" aria-label="Permalink to &quot;ä» React è¯´èµ·&quot;">â€‹</a></h2><p>èµ·åˆ <code>React</code> ä¹Ÿæ˜¯ä½¿ç”¨ <code>mixins</code> æ¥å®Œæˆä»£ç å¤ç”¨çš„ï¼Œæ¯”å¦‚ä¸ºäº†é¿å…ç»„ä»¶ä¸å¿…è¦çš„é‡å¤æ¸²æŸ“æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­æ··å…¥ <code>PureRenderMixin</code>ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PureRenderMixin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;react-addons-pure-render-mixin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MyComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mixins: [PureRenderMixin]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>åæ¥ <code>React</code> æŠ›å¼ƒäº†è¿™ç§æ–¹å¼ï¼Œè¿›è€Œä½¿ç”¨ <code>shallowCompare</code>ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> shallowCompare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;react-addons-shallow-compare&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Button</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  shouldComponentUpdate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">nextProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">nextState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shallowCompare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nextProps, nextState);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>è¿™éœ€è¦ä½ è‡ªå·±åœ¨ç»„ä»¶ä¸­å®ç° <code>shouldComponentUpdate</code> æ–¹æ³•ï¼Œåªä¸è¿‡è¿™ä¸ªæ–¹æ³•å…·ä½“çš„å·¥ä½œç”± <code>shallowCompare</code> å¸®ä½ å®Œæˆï¼Œå³æµ…æ¯”è¾ƒã€‚</p><p>å†åæ¥ <code>React</code> ä¸ºäº†é¿å…å¼€å‘è€…åœ¨ç»„ä»¶ä¸­æ€»æ˜¯è¦å†™è¿™æ ·ä¸€æ®µåŒæ ·çš„ä»£ç ï¼Œè¿›è€Œæ¨èä½¿ç”¨ <code>React.PureComponent</code>ï¼Œæ€»ä¹‹ <code>React</code> åœ¨ä¸€æ­¥æ­¥çš„è„±ç¦» <code>mixins</code>ï¼Œä»–ä»¬è®¤ä¸º <code>mixins</code> åœ¨ <code>React</code> ç”Ÿæ€ç³»ç»Ÿä¸­å¹¶ä¸æ˜¯ä¸€ç§å¥½çš„æ¨¡å¼(æ³¨æ„ï¼šå¹¶æ²¡æœ‰è¯´ <code>mixins</code> ä¸å¥½ï¼Œä»…ä»…é’ˆå¯¹ <code>React</code> ç”Ÿæ€ç³»ç»Ÿ)ï¼Œè§‚ç‚¹å¦‚ä¸‹ï¼š</p><blockquote><p>1ã€<code>mixins</code> å¸¦æ¥äº†éšå¼ä¾èµ– 2ã€<code>mixins</code> ä¸ <code>mixins</code> ä¹‹é—´ï¼Œ<code>mixins</code> ä¸ç»„ä»¶ä¹‹é—´å®¹æ˜“å¯¼è‡´å‘½åå†²çª 3ã€ç”±äº <code>mixins</code> æ˜¯ä¾µå…¥å¼çš„ï¼Œå®ƒæ”¹å˜äº†åŸç»„ä»¶ï¼Œæ‰€ä»¥ä¿®æ”¹ <code>mixins</code> ç­‰äºä¿®æ”¹åŸç»„ä»¶ï¼Œéšç€éœ€æ±‚çš„å¢é•¿ <code>mixins</code> å°†å˜å¾—å¤æ‚ï¼Œå¯¼è‡´æ»šé›ªçƒçš„å¤æ‚æ€§ã€‚</p></blockquote><p>å…·ä½“å¤§å®¶å¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  <a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html" target="_blank" rel="noreferrer">Mixins Considered Harmful</a>ã€‚ä¸è¿‡ <code>HOC</code> ä¹Ÿå¹¶ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒè‡ªç„¶å¸¦æ¥äº†å®ƒçš„é—®é¢˜ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æŸ¥çœ‹è¿™ä¸ªè§†é¢‘ï¼š<a href="https://www.youtube.com/watch?v=BcVAq3YFiuc" target="_blank" rel="noreferrer">Michael Jackson - Never Write Another HoC</a>ï¼Œå…¶è§‚ç‚¹æ˜¯ï¼š<strong>ä½¿ç”¨æ™®é€šç»„ä»¶é…åˆ render prop å¯ä»¥åšä»»ä½• HOC èƒ½åšçš„äº‹æƒ…</strong>ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä¸ä¼šè¿‡å¤šè®¨è®º <code>mixins</code> å’Œ <code>HOC</code> è°å¥½è°åï¼Œå°±åƒæŠ€æœ¯æœ¬èº«å°±æ²¡æœ‰å¥½åä¹‹åˆ†ï¼Œåªæœ‰é€‚åˆä¸é€‚åˆã€‚éš¾é“ <code>React</code> å’Œ <code>Vue</code> è¿™ä¿©å“¥ä»¬å„¿ä¸ä¹Ÿæ˜¯è¿™æ ·å—ğŸ™‚ã€‚</p><p><code>ok</code>ï¼Œæˆ‘ä»¬å›åˆ°é«˜é˜¶ç»„ä»¶ï¼Œæ‰€è°“é«˜é˜¶ç»„ä»¶å…¶å®å°±æ˜¯é«˜é˜¶å‡½æ•°å•¦ï¼Œ<code>React</code> å’Œ <code>Vue</code> éƒ½è¯æ˜äº†ä¸€ä»¶äº‹å„¿ï¼š<strong>ä¸€ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ªç»„ä»¶</strong>ã€‚æ‰€ä»¥ç»„ä»¶æ˜¯å‡½æ•°è¿™ä¸ªå‘½é¢˜æˆç«‹äº†ï¼Œé‚£é«˜é˜¶ç»„ä»¶å¾ˆè‡ªç„¶çš„å°±æ˜¯é«˜é˜¶å‡½æ•°ï¼Œå³ä¸€ä¸ªè¿”å›å‡½æ•°çš„å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ <code>React</code> ä¸­å†™é«˜é˜¶ç»„ä»¶å°±æ˜¯åœ¨å†™é«˜é˜¶å‡½æ•°ï¼Œå¾ˆç®€å•ï¼Œé‚£æ˜¯ä¸æ˜¯åœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶ä¹ŸåŒæ ·ç®€å•å‘¢ï¼Ÿå…¶å® <code>Vue</code> ç¨å¾®å¤æ‚ï¼Œç”šè‡³éœ€è¦ä½ å¯¹ <code>Vue</code> è¶³å¤Ÿäº†è§£ï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€å—åœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶ï¼Œåœ¨æ–‡ç« çš„åé¢ä¼šåˆ†æä¸ºä»€ä¹ˆåŒæ ·éƒ½æ˜¯ <code>å‡½æ•°å°±æ˜¯ç»„ä»¶</code> çš„æ€æƒ³ï¼Œ<code>Vue</code> å´ä¸èƒ½åƒ <code>React</code> é‚£æ ·è½»æ¾çš„å®ç°é«˜é˜¶ç»„ä»¶ã€‚</p><p>ä¹Ÿæ­£å› å¦‚æ­¤æ‰€ä»¥æˆ‘ä»¬æœ‰å¿…è¦åœ¨å®ç° <code>Vue</code> é«˜é˜¶ç»„ä»¶ä¹‹å‰å……åˆ†äº†è§£ <code>React</code> ä¸­çš„é«˜é˜¶ç»„ä»¶ï¼Œçœ‹ä¸‹é¢çš„ <code>React</code> ä»£ç ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> React</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    componentDidMount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;with console: componentDidMount&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.props}/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p><blockquote><p>1ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)åº”è¯¥æ˜¯æ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œä¸”ä¸åº”è¯¥ä¿®æ”¹åŸç»„ä»¶</p></blockquote><p>å¯ä»¥çœ‹åˆ° <code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›äº†ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œåœ¨æ–°ç»„ä»¶çš„ <code>render</code> å‡½æ•°ä¸­ä»…ä»…æ¸²æŸ“äº†è¢«åŒ…è£…çš„ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œå¹¶æ²¡æœ‰ä¾µå…¥å¼çš„ä¿®æ”¹å®ƒã€‚</p><blockquote><p>2ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸å…³å¿ƒä½ ä¼ é€’çš„æ•°æ®(<code>props</code>)æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ä¸å…³å¿ƒæ•°æ®æ¥æº</p></blockquote><p>è¿™æ˜¯ä¿è¯é«˜é˜¶ç»„ä»¶ä¸è¢«åŒ…è£…ç»„ä»¶èƒ½å¤Ÿå®Œç¾é…åˆçš„æ ¹æœ¬</p><blockquote><p>3ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)æ¥æ”¶åˆ°çš„ <code>props</code> åº”è¯¥é€ä¼ ç»™è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)</p></blockquote><p>é«˜é˜¶ç»„ä»¶å®Œå…¨å¯ä»¥æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ <code>props</code>ï¼Œä½†æ˜¯é™¤æ­¤ä¹‹å¤–ï¼Œè¦å°†å…¶ä½™ <code>props</code> é€ä¼ ï¼Œå¦åˆ™åœ¨å±‚çº§è¾ƒæ·±çš„åµŒå¥—å…³ç³»ä¸­(<code>è¿™æ˜¯é«˜é˜¶ç»„ä»¶çš„å¸¸è§é—®é¢˜</code>)å°†é€ æˆ <code>props</code> é˜»å¡ã€‚</p><p>ä»¥ä¸Šæ˜¯ <code>React</code> ä¸­é«˜é˜¶ç»„ä»¶çš„åŸºæœ¬çº¦å®šï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦æ³¨æ„å…¶ä»–é—®é¢˜ï¼Œå¦‚ï¼šé«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸åº”è¯¥åœ¨ <code>render</code> å‡½æ•°ä¸­åˆ›å»ºï¼›é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¹Ÿéœ€è¦å¤åˆ¶ç»„ä»¶ä¸­çš„é™æ€æ–¹æ³•ï¼›é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸­çš„ <code>ref</code> å¼•ç”¨çš„æ˜¯æœ€å¤–å±‚çš„å®¹å™¨ç»„ä»¶è€Œä¸æ˜¯è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>) ç­‰ç­‰ã€‚</p><h2 id="vue-ä¸­çš„é«˜é˜¶ç»„ä»¶" tabindex="-1">Vue ä¸­çš„é«˜é˜¶ç»„ä»¶ <a class="header-anchor" href="#vue-ä¸­çš„é«˜é˜¶ç»„ä»¶" aria-label="Permalink to &quot;Vue ä¸­çš„é«˜é˜¶ç»„ä»¶&quot;">â€‹</a></h2><p>äº†è§£äº†è¿™äº›ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç€æ‰‹å®ç° <code>Vue</code> é«˜é˜¶ç»„ä»¶äº†ï¼Œä¸ºäº†è®©å¤§å®¶æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ï¼Œæˆ‘ä»ç„¶ä¼šä½¿ç”¨ <code>React</code> ä¸ <code>Vue</code> è¿›è¡Œå¯¹æ¯”çš„è®²è§£ã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ <code>Vue</code> ç»„ä»¶ï¼Œæˆ‘ä»¬å¸¸ç§°å…¶ä¸ºè¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œå‡è®¾æˆ‘ä»¬çš„ç»„ä»¶å«åš <code>BaseComponent</code>ï¼š</p><p><strong>base-component.vue</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> @click=&quot;handleClick&quot;&gt;props:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {{test}}</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">&lt;/span&gt;</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  &lt;/div&gt;</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">&lt;/template&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">&lt;script&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">export</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;BaseComponent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    test: Number</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    handleClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;customize-click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">&lt;/script&gt;</span></span></code></pre></div><p>æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸ª <code>Vue</code> ç»„ä»¶ä¸»è¦è§‚å¯Ÿä¸‰ç‚¹ï¼š<code>props</code>ã€<code>event</code> ä»¥åŠ <code>slots</code>ã€‚å¯¹äº <code>BaseComponent</code> ç»„ä»¶è€Œè¨€ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ•°å­—ç±»å‹çš„ <code>props</code> å³ <code>test</code>ï¼Œå¹¶å‘å°„ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶çš„åç§°æ˜¯ï¼š<code>customize-click</code>ï¼Œæ²¡æœ‰ <code>slots</code>ã€‚æˆ‘ä»¬ä¼šè¿™æ ·ä½¿ç”¨è¯¥ç»„ä»¶ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> @customize-click=&quot;handleCustClick&quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> :test=&quot;100&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre></div><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ <code>base-component</code> ç»„ä»¶æ¯æ¬¡æŒ‚è½½å®Œæˆçš„æ—¶å€™éƒ½æ‰“å°ä¸€å¥è¯ï¼š<code>I have already mounted</code>ï¼ŒåŒæ—¶è¿™ä¹Ÿè®¸æ˜¯å¾ˆå¤šç»„ä»¶çš„éœ€æ±‚ï¼Œæ‰€ä»¥æŒ‰ç…§ <code>mixins</code> çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œé¦–å…ˆå®šä¹‰ä¸ª <code>mixins</code>ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> consoleMixin {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç„¶ååœ¨ <code>BaseComponent</code> ç»„ä»¶ä¸­å°† <code>consoleMixin</code> æ··å…¥ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;BaseComponent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    test: Number</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mixins: [ consoleMixin ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    handleClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;customize-click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>è¿™æ ·ä½¿ç”¨ <code>BaseComponent</code> ç»„ä»¶çš„æ—¶å€™ï¼Œæ¯æ¬¡æŒ‚è½½å®Œæˆä¹‹åéƒ½ä¼šæ‰“å°ä¸€å¥ <code>I have already mounted</code>ï¼Œä¸è¿‡ç°åœ¨æˆ‘ä»¬è¦ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„æ–¹å¼å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œå›å¿†é«˜é˜¶ç»„ä»¶çš„å®šä¹‰ï¼š<strong>æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶</strong>ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬éœ€è¦æ€è€ƒçš„æ˜¯ï¼Œåœ¨ <code>Vue</code> ä¸­ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæœ‰çš„åŒå­¦å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œéš¾é“ä¸æ˜¯å‡½æ•°å—ï¼Ÿå¯¹ï¼Œ<code>Vue</code> ä¸­ç»„ä»¶æ˜¯å‡½æ•°æ²¡æœ‰é—®é¢˜ï¼Œä¸è¿‡é‚£æ˜¯æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨å•æ–‡ä»¶ç»„ä»¶ä¸­çš„ç»„ä»¶å®šä¹‰å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„é€‰é¡¹å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;BaseComponent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mixins: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>è¿™ä¸å°±æ˜¯ä¸€ä¸ªçº¯å¯¹è±¡å—ï¼Ÿæ‰€ä»¥å½“æˆ‘ä»¬ä»å•æ–‡ä»¶ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BaseComponent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./base-component.vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(BaseComponent)</span></span></code></pre></div><p>æ€è€ƒä¸€ä¸‹ï¼Œè¿™é‡Œçš„ <code>BaseComponent</code> æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å‡½æ•°å—ï¼Ÿä¸æ˜¯ï¼Œè™½ç„¶å•æ–‡ä»¶ç»„ä»¶ä¼šè¢« <code>vue-loader</code> å¤„ç†ï¼Œä½†å¤„ç†åçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„ <code>BaseComponent</code> ä»ç„¶è¿˜æ˜¯ä¸€ä¸ªæ™®é€šçš„ JSON å¯¹è±¡ï¼Œåªä¸è¿‡å½“ä½ æŠŠè¿™ä¸ªå¯¹è±¡æ³¨å†Œä¸ºç»„ä»¶(<code>components</code> é€‰é¡¹)ä¹‹åï¼Œ<code>Vue</code> æœ€ç»ˆä¼šä»¥è¯¥å¯¹è±¡ä¸ºå‚æ•°åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°å°±æ˜¯ç”Ÿäº§ç»„ä»¶å®ä¾‹çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥åœ¨ <code>Vue</code> ä¸­ç»„ä»¶ç¡®å®æ˜¯å‡½æ•°ï¼Œåªä¸è¿‡é‚£æ˜¯æœ€ç»ˆç»“æœç½¢äº†ï¼Œåœ¨è¿™ä¹‹å‰æˆ‘ä»¬å®Œå…¨å¯ä»¥è¯´åœ¨ <code>Vue</code> ä¸­ç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå°±åƒå•æ–‡ä»¶ç»„ä»¶ä¸­æ‰€å¯¼å‡ºçš„å¯¹è±¡ä¸€æ ·ã€‚</p><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ <code>Vue</code> ä¸­ä¸€ä¸ªç»„ä»¶å¯ä»¥ä»¥çº¯å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥ <code>Vue</code> ä¸­çš„é«˜é˜¶ç»„ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ï¼š<strong>æ¥æ”¶ä¸€ä¸ªçº¯å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„çº¯å¯¹è±¡</strong>ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    template: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;wrapped v-on=&quot;$listeners&quot; v-bind=&quot;$attrs&quot;/&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    components: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      wrapped: WrappedComponent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼š<code>WrappedComponent</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚åœ¨æ–°çš„ç»„ä»¶å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å°† <code>WrappedComponent</code> æ³¨å†Œä¸º <code>wrapped</code> ç»„ä»¶ï¼Œå¹¶åœ¨ <code>template</code> ä¸­å°†å…¶æ¸²æŸ“å‡ºæ¥ï¼ŒåŒæ—¶æ·»åŠ  <code>mounted</code> é’©å­ï¼Œæ‰“å° <code>I have already mounted</code>ã€‚</p><p>ä»¥ä¸Šå°±å®Œæˆäº†ä¸ <code>mixins</code> åŒæ ·çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸€æ¬¡æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œæ‰€ä»¥æ˜¯éä¾µå…¥å¼çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹åŸç»„ä»¶(<code>WrappedComponent</code>)ï¼Œè€Œæ˜¯åœ¨æ–°ç»„ä»¶ä¸­æ¸²æŸ“äº†åŸç»„ä»¶ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹åŸç»„ä»¶åšä»»ä½•ä¿®æ”¹ã€‚å¹¶ä¸”è¿™é‡Œå¤§å®¶è¦æ³¨æ„ <code>$listeners</code> å’Œ <code>$attrs</code>ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;wrapped v-on=&quot;$listeners&quot; v-bind=&quot;$attrs&quot;/&gt;&#39;</span></span></code></pre></div><p>è¿™ä¹ˆåšæ˜¯å¿…é¡»çš„ï¼Œè¿™å°±ç­‰ä»·äºåœ¨ <code>React</code> ä¸­é€ä¼  <code>props</code>ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.props}/&gt;</span></span></code></pre></div><p>å¦åˆ™åœ¨ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„æ—¶å€™ï¼Œè¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)æ¥æ”¶ä¸åˆ° <code>props</code> å’Œ <code>äº‹ä»¶</code>ã€‚</p><p>é‚£è¿™æ ·çœŸçš„å°±å®Œç¾è§£å†³é—®é¢˜äº†å—ï¼Ÿä¸æ˜¯çš„ï¼Œé¦–å…ˆ <code>template</code> é€‰é¡¹åªæœ‰åœ¨å®Œæ•´ç‰ˆçš„ <code>Vue</code> ä¸­å¯ä»¥ä½¿ç”¨ï¼Œåœ¨è¿è¡Œæ—¶ç‰ˆæœ¬ä¸­æ˜¯ä¸èƒ½ä½¿ç”¨çš„ï¼Œæ‰€ä»¥æœ€èµ·ç æˆ‘ä»¬åº”è¯¥ä½¿ç”¨æ¸²æŸ“å‡½æ•°(<code>render</code>)æ›¿ä»£æ¨¡æ¿(<code>template</code>)ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†æ¨¡æ¿æ”¹å†™æˆäº†æ¸²æŸ“å‡½æ•°ï¼Œçœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå®åˆ™ä¸ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä¸­ <code>WrappedComponent</code> ç»„ä»¶ä¾ç„¶æ”¶ä¸åˆ° <code>props</code>ï¼Œæœ‰çš„åŒå­¦å¯èƒ½ä¼šé—®äº†ï¼Œæˆ‘ä»¬ä¸æ˜¯å·²ç»åœ¨ <code>h</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­å°† <code>attrs</code> ä¼ é€’è¿‡å»äº†å—ï¼Œæ€ä¹ˆè¿˜æ”¶ä¸åˆ°ï¼Ÿå½“ç„¶æ”¶ä¸åˆ°ï¼Œ<code>attrs</code> æŒ‡çš„æ˜¯é‚£äº›æ²¡æœ‰è¢«å£°æ˜ä¸º <code>props</code> çš„å±æ€§ï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“å‡½æ•°ä¸­è¿˜éœ€è¦æ·»åŠ  <code>props</code> å‚æ•°ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        props: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$props</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>é‚£è¿™æ ·æ˜¯ä¸æ˜¯å¯ä»¥äº†å‘¢ï¼Ÿä¾ç„¶ä¸è¡Œï¼Œå› ä¸º <code>this.$props</code> å§‹ç»ˆæ˜¯ç©ºå¯¹è±¡ï¼Œè¿™æ˜¯å› ä¸ºè¿™é‡Œçš„ <code>this.$props</code> æŒ‡çš„æ˜¯é«˜é˜¶ç»„ä»¶æ¥æ”¶åˆ°çš„ <code>props</code>ï¼Œè€Œé«˜é˜¶ç»„ä»¶æ²¡æœ‰å£°æ˜ä»»ä½• <code>props</code>ï¼Œæ‰€ä»¥ <code>this.$props</code> è‡ªç„¶æ˜¯ç©ºå¯¹è±¡å•¦ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿå¾ˆç®€å•åªéœ€è¦å°†é«˜é˜¶ç»„ä»¶çš„ <code>props</code> è®¾ç½®ä¸è¢«åŒ…è£…ç»„ä»¶çš„ <code>props</code> ç›¸åŒå³å¯äº†ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    props: WrappedComponent.props,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        props: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$props</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç°åœ¨æ‰æ˜¯ä¸€ä¸ªç¨å¾®å®Œæ•´å¯ç”¨çš„é«˜é˜¶ç»„ä»¶ã€‚å¤§å®¶æ³¨æ„ç”¨è¯ï¼š<code>ç¨å¾®</code>ï¼Œçº³å°¼ï¼Ÿéƒ½ä¿®æ”¹æˆè¿™æ ·äº†è¿˜ä¸è¡Œå—ï¼Ÿå½“ç„¶ï¼Œä¸Šé¢çš„é«˜é˜¶ç»„ä»¶èƒ½å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p><blockquote><p>1ã€é€ä¼  <code>props</code> 2ã€é€ä¼ æ²¡æœ‰è¢«å£°æ˜ä¸º <code>props</code> çš„å±æ€§ 3ã€é€ä¼ äº‹ä»¶</p></blockquote><p>å¤§å®¶ä¸è§‰å¾—ç¼ºå°‘ç‚¹å„¿ä»€ä¹ˆå—ï¼Ÿæˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œä¸€ä¸ª <code>Vue</code> ç»„ä»¶çš„ä¸‰ä¸ªé‡è¦å› ç´ ï¼š<code>props</code>ã€<code>äº‹ä»¶</code> ä»¥åŠ <code>slots</code>ï¼Œå‰ä¸¤ä¸ªéƒ½æå®šäº†ï¼Œä½† <code>slots</code> è¿˜ä¸è¡Œã€‚æˆ‘ä»¬ä¿®æ”¹ <code>BaseComponent</code> ç»„ä»¶ä¸ºå…¶æ·»åŠ ä¸€ä¸ªå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>base-component.vue</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> @click=&quot;handleClick&quot;&gt;props:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {{test}}</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">&lt;/span&gt;</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">    &lt;slot</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt; &lt;!-- å…·åæ’æ§½ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;===========&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">slot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt; &lt;!-- é»˜è®¤æ’æ§½ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">export default {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>ç„¶åæˆ‘ä»¬å†™ä¸‹å¦‚ä¸‹æµ‹è¯•ä»£ç ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;BaseComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;default slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enhanced-com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;EnhancedComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;default slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enhanced-com</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  import BaseComponent from &#39;./base-component.vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  import hoc from &#39;./hoc.js&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  const EnhancedCom = hoc(BaseComponent)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  export default {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    components: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      BaseComponent,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      EnhancedCom</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>æ¸²æŸ“ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-084715.jpg" alt="img"></p><p>ä¸Šå›¾ä¸­è“è‰²æ¡†æ˜¯ <code>BaseComponent</code> ç»„ä»¶æ¸²æŸ“çš„å†…å®¹ï¼Œæ˜¯æ­£å¸¸çš„ã€‚çº¢è‰²æ¡†æ˜¯é«˜é˜¶ç»„ä»¶æ¸²æŸ“çš„å†…å®¹ï¼Œå¯ä»¥å‘ç°æ— è®ºæ˜¯å…·åæ’æ§½è¿˜æ˜¯é»˜è®¤æ’æ§½å…¨éƒ¨ä¸¢å¤±ã€‚å…¶åŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é«˜é˜¶ç»„ä»¶ä¸­æ²¡æœ‰å°†åˆ†å‘çš„æ’æ§½å†…å®¹é€ä¼ ç»™è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç€ä¿®æ”¹é«˜é˜¶ç»„ä»¶ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    props: WrappedComponent.props,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // å°† this.$slots æ ¼å¼åŒ–ä¸ºæ•°ç»„ï¼Œå› ä¸º h å‡½æ•°ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reduce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots[key]), [])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        props: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$props</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }, slots) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å°† slots ä½œä¸º h å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>å¥½å•¦ï¼Œå¤§åŠŸå‘Šæˆåˆ·æ–°é¡µé¢ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-090407.jpg" alt="img"></p><p>çº³å°¼ğŸ˜±ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œåˆ†å‘çš„å†…å®¹ç¡®å®æ˜¯æ¸²æŸ“å‡ºæ¥äº†ï¼Œä¸è¿‡è²Œä¼¼é¡ºåºä¸å¤ªå¯¹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è“è‰²æ¡†æ˜¯æ­£å¸¸çš„ï¼Œåœ¨å…·åæ’æ§½ä¸é»˜è®¤æ’æ§½çš„ä¸­é—´æ˜¯æœ‰åˆ†ç•Œçº¿(<code>===========</code>)çš„ï¼Œè€Œçº¢è‰²æ¡†ä¸­æ‰€æœ‰çš„æ’æ§½å…¨éƒ¨æ¸²æŸ“åˆ°äº†åˆ†ç•Œçº¿(<code>===========</code>)çš„ä¸‹é¢ï¼Œçœ‹ä¸Šå»è²Œä¼¼å…·åæ’æ§½ä¹Ÿè¢«ä½œä¸ºé»˜è®¤æ’æ§½å¤„ç†äº†ã€‚è¿™åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>æƒ³å¼„æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œå°±å›åˆ°äº†æ–‡ç« å¼€å§‹æ—¶æˆ‘æåˆ°çš„ä¸€ç‚¹ï¼Œå³ä½ éœ€è¦å¯¹ <code>Vue</code> çš„å®ç°åŸç†æœ‰æ‰€äº†è§£æ‰è¡Œï¼Œå¦åˆ™æ— è§£ã€‚æ¥ä¸‹æ¥å°±ä»åŸç†è§¦å‘è®²è§£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºï¼š<strong>Vue åœ¨å¤„ç†å…·åæ’æ§½çš„æ—¶å€™ä¼šè€ƒè™‘ä½œç”¨åŸŸçš„å› ç´ </strong>ã€‚ä¸æ˜ç™½æ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä¸€ç‚¹ç‚¹åˆ†æã€‚</p><p>é¦–å…ˆè¡¥å……ä¸€ä¸ªæç¤ºï¼š<strong>Vue ä¼šæŠŠæ¨¡æ¿(template)ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°(render)</strong>ï¼Œæ¯”å¦‚å¦‚ä¸‹æ¨¡æ¿ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;BaseComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>ä¼šè¢«ç¼–è¯‘æˆå¦‚ä¸‹æ¸²æŸ“å‡½æ•°ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _h </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm.$createElement</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm._self._c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;h2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      attrs: { slot: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      slot: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      _vm.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;BaseComponent slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>æƒ³è¦æŸ¥çœ‹ä¸€ä¸ªç»„ä»¶çš„æ¨¡æ¿è¢«ç¼–è¯‘åçš„æ¸²æŸ“å‡½æ•°å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨è®¿é—® <code>this.$options.render</code> å³å¯ã€‚è§‚å¯Ÿä¸Šé¢çš„æ¸²æŸ“å‡½æ•°æˆ‘ä»¬å‘ç°æ™®é€šçš„ <code>DOM</code> æ˜¯é€šè¿‡ <code>_c</code> å‡½æ•°åˆ›å»ºå¯¹åº”çš„ <code>VNode</code> çš„ã€‚ç°åœ¨æˆ‘ä»¬ä¿®æ”¹æ¨¡æ¿ï¼Œæ¨¡æ¿ä¸­é™¤äº†æœ‰æ™®é€š <code>DOM</code> ä¹‹å¤–ï¼Œè¿˜æœ‰ç»„ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;BaseComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;default slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>é‚£ä¹ˆç”Ÿæˆçš„æ¸²æŸ“å‡½æ•°(<code>render</code>)æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _h </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm.$createElement</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _vm._self._c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _h</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;div&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;base-component&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;h2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { attrs: { slot: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, slot: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          _vm.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;BaseComponent slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        _vm.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        _c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;p&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [_vm.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>æˆ‘ä»¬å‘ç°æ— è®ºæ˜¯æ™®é€šDOMè¿˜æ˜¯ç»„ä»¶ï¼Œéƒ½æ˜¯é€šè¿‡ <code>_c</code> å‡½æ•°åˆ›å»ºå…¶å¯¹åº”çš„ <code>VNode</code> çš„ã€‚å…¶å® <code>_c</code> åœ¨ <code>Vue</code> å†…éƒ¨å°±æ˜¯ <code>createElement</code> å‡½æ•°ã€‚<code>createElement</code> å‡½æ•°ä¼šè‡ªåŠ¨æ£€æµ‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸æ˜¯æ™®é€šDOMæ ‡ç­¾ï¼Œå¦‚æœä¸æ˜¯æ™®é€šDOMæ ‡ç­¾é‚£ä¹ˆ <code>createElement</code> ä¼šå°†å…¶è§†ä¸ºç»„ä»¶ï¼Œå¹¶ä¸”åˆ›å»ºç»„ä»¶å®ä¾‹ï¼Œ<strong>æ³¨æ„ç»„ä»¶å®ä¾‹æ˜¯è¿™ä¸ªæ—¶å€™æ‰åˆ›å»ºçš„</strong>ã€‚ä½†æ˜¯åˆ›å»ºç»„ä»¶å®ä¾‹çš„è¿‡ç¨‹ä¸­å°±é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼š<strong>ç»„ä»¶éœ€è¦çŸ¥é“çˆ¶çº§æ¨¡æ¿ä¸­æ˜¯å¦ä¼ é€’äº† slot ä»¥åŠä¼ é€’äº†å¤šå°‘ï¼Œä¼ é€’çš„æ˜¯å…·åçš„è¿˜æ˜¯ä¸å…·åçš„ç­‰ç­‰</strong>ã€‚é‚£ä¹ˆå­ç»„ä»¶å¦‚ä½•æ‰èƒ½å¾—çŸ¥è¿™äº›ä¿¡æ¯å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå‡å¦‚ç»„ä»¶çš„æ¨¡æ¿å¦‚ä¸‹ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;BaseComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;default slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>çˆ¶ç»„ä»¶çš„æ¨¡æ¿æœ€ç»ˆä¼šç”Ÿæˆçˆ¶ç»„ä»¶å¯¹åº”çš„ <code>VNode</code>ï¼Œæ‰€ä»¥ä»¥ä¸Šæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code> å…¨éƒ¨ç”±çˆ¶ç»„ä»¶æ‰€æœ‰ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºå­ç»„ä»¶å®ä¾‹çš„æ—¶å€™èƒ½å¦é€šè¿‡è·å–çˆ¶ç»„ä»¶çš„ <code>VNode</code> è¿›è€Œæ‹¿åˆ° <code>slot</code> çš„å†…å®¹å‘¢ï¼Ÿå³é€šè¿‡çˆ¶ç»„ä»¶å°†ä¸‹é¢è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code> æ‹¿åˆ°ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> slot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;slot1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;BaseComponent slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;default slot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">base-component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>å¦‚æœèƒ½å¤Ÿé€šè¿‡çˆ¶çº§æ‹¿åˆ°è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code>ï¼Œé‚£ä¹ˆå­ç»„ä»¶å°±çŸ¥é“è¦æ¸²æŸ“å“ªäº› <code>slot</code> äº†ï¼Œå…¶å® <code>Vue</code> å†…éƒ¨å°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼Œå®é™…ä¸Šä½ å¯ä»¥é€šè¿‡è®¿é—®å­ç»„ä»¶çš„ <code>this.$vnode</code> æ¥è·å–è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code>ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-102532.jpg" alt="img"></p><p>å…¶ä¸­ <code>this.$vnode</code> å¹¶æ²¡æœ‰å†™è¿› <code>Vue</code> çš„å®˜æ–¹æ–‡æ¡£ã€‚å­ç»„ä»¶æ‹¿åˆ°äº†éœ€è¦æ¸²æŸ“çš„ <code>slot</code> ä¹‹åè¿›å…¥åˆ°äº†å…³é”®çš„ä¸€æ­¥ï¼Œè¿™ä¸€æ­¥å°±æ˜¯å¯¼è‡´é«˜é˜¶ç»„ä»¶ä¸­é€ä¼  <code>slot</code> ç»™ <code>BaseComponent</code> å´æ— æ³•æ­£ç¡®æ¸²æŸ“çš„åŸå› ï¼Œçœ‹ä¸‹å›¾ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-104411.jpg" alt="img"></p><p>è¿™å¼ å›¾ä¸ä¸Šä¸€å¼ å›¾ç›¸åŒï¼Œåœ¨å­ç»„ä»¶ä¸­æ‰“å° <code>this.$vnode</code>ï¼Œæ ‡æ³¨ä¸­çš„ <code>context</code> å¼•ç”¨ç€ <code>VNode</code> è¢«åˆ›å»ºæ—¶æ‰€åœ¨çš„ç»„ä»¶å®ä¾‹ï¼Œç”±äº <code>this.$vnode</code> ä¸­å¼•ç”¨çš„ <code>VNode</code> å¯¹è±¡æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­è¢«åˆ›å»ºçš„ï¼Œæ‰€ä»¥ <code>this.$vnode</code> ä¸­çš„ <code>context</code> å¼•ç”¨ç€çˆ¶å®ä¾‹ã€‚ç†è®ºä¸Šå›¾ä¸­æ ‡æ³¨çš„ä¸¤ä¸ª <code>context</code> åº”è¯¥æ˜¯ç›¸ç­‰çš„ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$vnode.context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$vnode.componentOptions.children[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].context) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// true</span></span></code></pre></div><p>è€Œ <code>Vue</code> å†…éƒ¨åšäº†ä¸€ä»¶å¾ˆé‡è¦çš„äº‹å„¿ï¼Œå³ä¸Šé¢é‚£ä¸ªè¡¨è¾¾å¼å¿…é¡»æˆç«‹ï¼Œæ‰èƒ½å¤Ÿæ­£ç¡®å¤„ç†å…·å <code>slot</code>ï¼Œå¦åˆ™å³ä½¿ <code>slot</code> å…·åä¹Ÿä¸ä¼šè¢«è€ƒè™‘ï¼Œè€Œæ˜¯è¢«ä½œä¸ºé»˜è®¤æ’æ§½ã€‚è¿™å°±æ˜¯é«˜é˜¶ç»„ä»¶ä¸­ä¸èƒ½æ­£ç¡®æ¸²æŸ“ <code>slot</code> çš„åŸå› ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆé«˜é˜¶ç»„ä»¶ä¸­ä¸Šé¢çš„è¡¨è¾¾å¼å°±ä¸æˆç«‹äº†å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºç”±äºé«˜é˜¶ç»„ä»¶çš„å¼•å…¥ï¼Œåœ¨åŸæœ¬çš„çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶ä¹‹é—´æ’å…¥äº†ä¸€ä¸ªç»„ä»¶(<code>ä¹Ÿå°±æ˜¯é«˜é˜¶ç»„ä»¶</code>)ï¼Œè¿™å¯¼è‡´åœ¨å­ç»„ä»¶ä¸­è®¿é—®çš„ <code>this.$vnode</code> å·²ç»ä¸æ˜¯åŸæ¥çš„çˆ¶ç»„ä»¶ä¸­çš„ <code>VNode</code> ç‰‡æ®µäº†ï¼Œè€Œæ˜¯é«˜é˜¶ç»„ä»¶çš„ <code>VNode</code> ç‰‡æ®µï¼Œæ‰€ä»¥æ­¤æ—¶ <code>this.$vnode.context</code> å¼•ç”¨çš„æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å´å°† <code>slot</code> é€ä¼ ï¼Œ<code>slot</code> ä¸­çš„ <code>VNode</code> çš„ <code>context</code> å¼•ç”¨çš„è¿˜æ˜¯åŸæ¥çš„çˆ¶ç»„ä»¶å®ä¾‹ï¼Œæ‰€ä»¥è¿™å°±é€ æˆäº†ä»¥ä¸‹è¡¨è¾¾å¼ä¸ºå‡ï¼š</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$vnode.context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$vnode.componentOptions.children[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].context) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// false</span></span></code></pre></div><p>æœ€ç»ˆå¯¼è‡´å…·åæ’æ§½è¢«ä½œä¸ºé»˜è®¤æ’æ§½ï¼Œä»è€Œæ¸²æŸ“ä¸æ­£ç¡®ã€‚</p><p>è€Œè§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹ <code>slot</code> ä¸­ <code>VNode</code> çš„ <code>context</code> å€¼ä¸ºé«˜é˜¶ç»„ä»¶å®ä¾‹å³å¯ï¼Œä¿®æ”¹é«˜é˜¶ç»„ä»¶å¦‚ä¸‹ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    props: WrappedComponent.props,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reduce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots[key]), [])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æ‰‹åŠ¨æ›´æ­£ context</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vnode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          vnode.context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._self</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vnode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        props: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$props,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }, slots)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç°åœ¨ï¼Œéƒ½èƒ½å¤Ÿæ­£å¸¸æ¸²æŸ“å•¦ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-113740.jpg" alt="img"></p><p>è¿™é‡Œçš„å…³é”®ç‚¹é™¤äº†ä½ éœ€è¦äº†è§£ <code>Vue</code> å¤„ç† <code>slot</code> çš„æ–¹å¼ä¹‹å¤–ï¼Œä½ è¿˜è¦çŸ¥é“é€šè¿‡å½“å‰å®ä¾‹ <code>_self</code> å±æ€§è®¿é—®å½“å®ä¾‹æœ¬èº«ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ <code>this</code>ï¼Œå› ä¸º <code>this</code> æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚</p><p>ç°åœ¨è²Œä¼¼çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜äº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜å¿˜è®°äº†ä¸€ä»¶äº‹å„¿ï¼Œå³ <code>scopedSlots</code>ï¼Œä¸è¿‡ <code>scopedSlots</code> ä¸ <code>slot</code> çš„å®ç°æœºåˆ¶ä¸ä¸€æ ·ï¼Œæœ¬è´¨ä¸Š <code>scopedSlots</code> å°±æ˜¯ä¸€ä¸ªæ¥æ”¶æ•°æ®ä½œä¸ºå‚æ•°å¹¶æ¸²æŸ“ <code>VNode</code> çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ <code>context</code> çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›´æ¥é€ä¼ å³å¯ï¼š</p><p><strong>hoc.js</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WithConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">WrappedComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;I have already mounted&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    props: WrappedComponent.props,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reduce</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">arr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">concat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$slots[key]), [])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vnode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          vnode.context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._self</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vnode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WrappedComponent, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        on: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$listeners,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        props: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$props,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // é€ä¼  scopedSlots</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        scopedSlots: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$scopedSlots,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attrs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.$attrs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }, slots)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä¸€ä¸ªé«˜é˜¶ç»„ä»¶åº”è¯¥å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½ç®—æ˜¯å®ç°äº†ï¼Œä½†è¿™ä»…ä»…æ˜¯ä¸ªå¼€å§‹ï¼Œè¦å®ç°ä¸€ä¸ªå®Œæ•´å¥å£®çš„ <code>Vue</code> é«˜é˜¶ç»„ä»¶ï¼Œè¿˜è¦è€ƒè™‘å¾ˆå¤šå†…å®¹ï¼Œæ¯”å¦‚ï¼š</p><blockquote><p>å‡½æ•°å¼ç»„ä»¶ä¸­è¦ä½¿ç”¨ <code>render</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä»£æ›¿ <code>this</code>ã€‚ ä»¥ä¸Šæˆ‘ä»¬åªè®¨è®ºäº†ä»¥çº¯å¯¹è±¡å½¢å¼å­˜åœ¨çš„ <code>Vue</code> ç»„ä»¶ï¼Œç„¶è€Œé™¤äº†çº¯å¯¹è±¡å¤–è¿˜å¯ä»¥å‡½æ•°ã€‚ åˆ›å»º <code>render</code> å‡½æ•°çš„å¾ˆå¤šæ­¥éª¤éƒ½å¯ä»¥è¿›è¡Œå°è£…ã€‚ å¤„ç†æ›´å¤šé«˜é˜¶å‡½æ•°ç»„ä»¶æœ¬èº«çš„é€‰é¡¹(<code>è€Œä¸ä»…ä»…æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ä¸€ä¸ªç®€å•çš„ç”Ÿå‘½å‘¨æœŸé’©å­</code>)</p></blockquote><p>æˆ‘è§‰å¾—éœ€è¦æ”¾ä¸Šä¸¤ä¸ªå…³äºé«˜é˜¶ç»„ä»¶çš„å‚è€ƒé“¾æ¥ï¼Œä¾›å‚è€ƒäº¤æµï¼š</p><p><a href="https://github.com/vuejs/vue/issues/6201" target="_blank" rel="noreferrer">Discussion: Best way to create a HOC</a><a href="https://github.com/jackmellis/vue-hoc" target="_blank" rel="noreferrer">https://github.com/jackmellis/vue-hoc</a></p><h2 id="ä¸ºä»€ä¹ˆåœ¨-vue-ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾" tabindex="-1">ä¸ºä»€ä¹ˆåœ¨ Vue ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾ <a class="header-anchor" href="#ä¸ºä»€ä¹ˆåœ¨-vue-ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾" aria-label="Permalink to &quot;ä¸ºä»€ä¹ˆåœ¨ Vue ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾&quot;">â€‹</a></h2><p>å‰é¢è¯´è¿‡è¦åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆåœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒå¤æ‚è€Œ <code>React</code> æ¯”è¾ƒç®€å•ã€‚è¿™ä¸»è¦æ˜¯äºŒè€…çš„è®¾è®¡æ€æƒ³å’Œè®¾è®¡ç›®æ ‡ä¸åŒï¼Œåœ¨ <code>React</code> ä¸­å†™ç»„ä»¶å°±æ˜¯åœ¨å†™å‡½æ•°ï¼Œå‡½æ•°æ‹¥æœ‰çš„åŠŸèƒ½ç»„ä»¶éƒ½æœ‰ã€‚è€Œ <code>Vue</code> æ›´åƒæ˜¯é«˜åº¦å°è£…çš„å‡½æ•°ï¼Œåœ¨æ›´é«˜çš„å±‚é¢ <code>Vue</code> èƒ½å¤Ÿè®©ä½ è½»æ¾çš„å®Œæˆä¸€äº›äº‹æƒ…ï¼Œä½†ä¸é«˜åº¦çš„å°è£…ç›¸å¯¹çš„å°±æ˜¯æŸå¤±ä¸€å®šçš„çµæ´»ï¼Œä½ éœ€è¦æŒ‰ç…§ä¸€å®šè§„åˆ™æ‰èƒ½ä½¿ç³»ç»Ÿæ›´å¥½çš„è¿è¡Œã€‚</p><p>æœ‰å¥è¯è¯´çš„å¥½ï¼š</p><blockquote><p>ä¼šäº†ä¸éš¾ï¼Œéš¾äº†ä¸ä¼š</p></blockquote><p>å¤æ‚è¿˜æ˜¯ç®€å•éƒ½æ˜¯ç›¸å¯¹è€Œè¨€çš„ï¼Œæœ€åå¸Œæœ›å¤§å®¶ç©çš„è½¬ <code>Vue</code> ä¹Ÿæ¬£èµçš„äº† <code>React</code>ã€‚</p><p>åŸæ–‡ï¼š<a href="http://hcysun.me/2018/01/05/%E6%8E%A2%E7%B4%A2Vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/" target="_blank" rel="noreferrer">http://hcysun.me/2018/01/05/æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶/</a></p>`,113),h=[t];function l(e,k,E,d,o,r){return a(),i("div",null,h)}const y=s(p,[["render",l]]);export{g as __pageData,y as default};
